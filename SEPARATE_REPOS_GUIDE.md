# Working with Generated Projects and Existing Repositories

This guide explains how to work with projects generated by CodeGen Automator and how to modify existing projects in separate repositories.

## Table of Contents

1. [Moving Generated Projects to Separate Repositories](#moving-generated-projects-to-separate-repositories)
2. [Modifying Existing Projects in Different Repositories](#modifying-existing-projects-in-different-repositories)
3. [Setup Requirements](#setup-requirements)
4. [Workflows Overview](#workflows-overview)

---

## Moving Generated Projects to Separate Repositories

### Overview

After generating a project using CodeGen Automator, you may want to move it to its own standalone repository for development. This allows:

- Independent version control
- Separate CI/CD pipelines
- Team-specific access control
- Clean separation from generation scripts

### How It Works

1. **Create an Issue** using the "Create Separate Repository" template
2. **Workflow Triggers** and validates the project exists
3. **New Repository Created** in GitHub (public or private)
4. **Code is Pushed** to the new repository
5. **Topics Added** for easy discovery

### Step-by-Step Guide

#### 1. Create Repository Request Issue

Navigate to **Issues ‚Üí New Issue ‚Üí "üì§ Create Separate Repository"**

Fill in the template:

```yaml
Project Name: my-awesome-app  # From generated-projects/ folder
Repository Visibility: private  # or public
Target Organization: my-org  # Optional, leave empty for personal account
Additional Setup Steps:
  - Add john.doe@company.com as collaborator
  - Enable branch protection on main
  - Configure deployment secrets
```

#### 2. Manual Workflow Trigger

The workflow is triggered manually via **Actions ‚Üí Create Separate Repository ‚Üí Run workflow**

**Inputs:**
- **project_name**: Name of the project in `generated-projects/`
- **repo_visibility**: `private` or `public`
- **target_org**: Organization name (optional)

#### 3. Automated Process

The workflow will:

```bash
‚úì Verify project exists in generated-projects/
‚úì Create new GitHub repository
‚úì Initialize git in project folder
‚úì Push all files to new repository
‚úì Add topics: codegen-automator, auto-generated
‚úì Comment on issue with repository URL
```

#### 4. Result

You'll get:

- ‚úÖ New repository: `https://github.com/username/my-awesome-app`
- ‚úÖ All generated code committed
- ‚úÖ README with setup instructions
- ‚úÖ Ready for development

### Example Output

```
‚úÖ Repository created successfully!

üîó Repository: https://github.com/yashwanth-tfs/my-dashboard-app
üì¶ Topics: codegen-automator, auto-generated

Next steps:
  git clone https://github.com/yashwanth-tfs/my-dashboard-app
  cd my-dashboard-app
  npm install  # or pip install -r requirements.txt
  npm start    # or python app/main.py
```

### Manual Alternative

If you prefer manual control:

```bash
# Navigate to generated project
cd generated-projects/my-awesome-app

# Initialize git
git init
git add .
git commit -m "Initial commit from CodeGen Automator"

# Create repository on GitHub (via gh CLI or web UI)
gh repo create my-awesome-app --private --source=. --remote=origin --push

# Or use web UI and then:
git remote add origin https://github.com/username/my-awesome-app.git
git branch -M main
git push -u origin main
```

---

## Modifying Existing Projects in Different Repositories

### Overview

If you have an **existing project in a separate repository** (not generated by CodeGen Automator), you can use the modification workflow to:

- Add new features
- Create new API endpoints
- Add new Angular components
- Update dependencies
- Refactor code

### How It Works

1. **Create an Issue** using the "Modify Existing Project" template
2. **Workflow Triggers** and clones the target repository
3. **Modifications Applied** based on project type (Python/Angular)
4. **Branch Created** in target repository
5. **Pull Request Created** in target repository for review

### Step-by-Step Guide

#### 1. Create Modification Request Issue

Navigate to **Issues ‚Üí New Issue ‚Üí "üîß Modify Existing Project"**

Fill in the template:

```yaml
Target Repository: yashwanth-tfs/my-existing-api
Project Type: Python (FastAPI)
Modification Type: feature
Description: |
  Add user authentication module with:
  - Login/logout endpoints
  - JWT token generation
  - Password hashing with bcrypt
  - User model with SQLAlchemy

Files to Modify/Create:
  Create:
  - app/api/routes/auth.py
  - app/models/domain/user.py
  - app/services/auth_service.py
  - app/repositories/user_repository.py
  - tests/test_auth.py
  
  Modify:
  - app/main.py (add auth routes)
  - requirements.txt (add dependencies)

New Dependencies:
  - PyJWT==2.8.0
  - bcrypt==4.1.2
  - python-jose[cryptography]==3.3.0

Base Branch: main
```

#### 2. Workflow Execution

The workflow automatically:

```bash
‚úì Checkout target repository
‚úì Parse modification request
‚úì Detect project type (FastAPI/Flask/Django/Angular)
‚úì Create modification branch: codegen/modify-123
‚úì Apply changes (create files, update dependencies)
‚úì Commit changes
‚úì Push to target repository
‚úì Create Pull Request in target repository
```

#### 3. Review and Merge

You'll receive a PR in the **target repository**:

```
Title: CodeGen: Modifications from issue #123
Body:
  This PR applies modifications requested in issue #123 from CodeGen Automator.
  
  Modification Type: feature
  
  Changes:
  - Added auth API endpoints
  - Created user service and repository
  - Updated dependencies
  
  ‚ö†Ô∏è Please review the changes carefully before merging.
```

### Supported Modifications

#### Python (FastAPI) Projects

**Automatically Generates:**
- ‚úÖ API route files (`app/api/routes/*.py`)
- ‚úÖ Service layer (`app/services/*_service.py`)
- ‚úÖ Repository layer (`app/repositories/*_repository.py`)
- ‚úÖ Updated `app/main.py` with new routes
- ‚úÖ Updated `requirements.txt` with dependencies

**Example Output:**
```python
# app/api/routes/auth.py
@router.post("/login")
async def login(credentials: LoginRequest, db: Session = Depends(get_db)):
    service = AuthService(db)
    return await service.authenticate(credentials)

# app/services/auth_service.py
class AuthService:
    def __init__(self, db: Session):
        self.repository = UserRepository(db)
    
    async def authenticate(self, credentials):
        # Authentication logic
        pass
```

#### Angular Projects

**Automatically Generates:**
- ‚úÖ Feature module (`app/features/*/feature.module.ts`)
- ‚úÖ Component files (TS, HTML, SCSS)
- ‚úÖ Service files (`app/features/*/services/*.service.ts`)
- ‚úÖ Updated routing in `app-routing.module.ts`
- ‚úÖ Updated `package.json` with dependencies

**Example Output:**
```typescript
// app/features/auth/components/auth/auth.component.ts
@Component({
  selector: 'app-auth',
  templateUrl: './auth.component.html',
  styleUrls: ['./auth.component.scss']
})
export class AuthComponent implements OnInit {
  constructor(private authService: AuthService) {}
}

// app/features/auth/services/auth.service.ts
@Injectable({ providedIn: 'root' })
export class AuthService {
  login(credentials: LoginRequest): Observable<AuthResponse> {
    return this.http.post<AuthResponse>(`${this.apiUrl}/login`, credentials);
  }
}
```

---

## Setup Requirements

### For Creating Separate Repositories

**Required:**
- ‚úÖ GitHub token with `repo` scope (automatic with `GITHUB_TOKEN`)
- ‚úÖ Project exists in `generated-projects/` folder

**Optional:**
- Personal Access Token (PAT) for organization repos

### For Modifying Existing Projects

**Required:**
- ‚úÖ Personal Access Token (PAT) with `repo` scope
- ‚úÖ Access to target repository
- ‚úÖ Target repository must be accessible (public or you have access)

**Setup PAT:**

1. Go to **GitHub Settings ‚Üí Developer settings ‚Üí Personal access tokens ‚Üí Tokens (classic)**
2. Click **Generate new token (classic)**
3. Select scopes:
   - ‚úÖ `repo` (Full control of private repositories)
   - ‚úÖ `workflow` (Update GitHub Action workflows)
4. Copy the token
5. Add to repository secrets:
   - Go to **Repository Settings ‚Üí Secrets and variables ‚Üí Actions**
   - Create secret: `PAT_TOKEN` = your token

### Why PAT is Needed

The default `GITHUB_TOKEN` has limited scope and **cannot access other repositories**. For cross-repository operations, you need a PAT with appropriate permissions.

---

## Workflows Overview

### Workflow Files

| Workflow | File | Trigger | Purpose |
|----------|------|---------|---------|
| Create Separate Repo | `create-separate-repo.yml` | Manual (`workflow_dispatch`) | Move generated project to new repo |
| Modify Existing | `modify-existing-project.yml` | Issue with `modify-existing` label | Add changes to existing repo |

### Issue Templates

| Template | File | Label | Purpose |
|----------|------|-------|---------|
| Create Repo | `create-repo.yml` | `create-repo` | Request new repository creation |
| Modify Existing | `modify-existing.yml` | `modify-existing` | Request modifications to existing project |

### Scripts

| Script | Purpose | Input | Output |
|--------|---------|-------|--------|
| `parse-modification-request.js` | Parse modification issue | Issue metadata JSON | Modifications JSON |
| `modify-python.py` | Apply changes to Python project | Modifications JSON | New/modified Python files |
| `modify-angular.js` | Apply changes to Angular project | Modifications JSON | New/modified Angular files |

---

## Examples

### Example 1: Create Repository for Generated FastAPI Project

```yaml
# Issue: Create Separate Repository
Project Name: user-management-api
Repository Visibility: private
Target Organization: thermofisher-labs
```

**Result:**
- ‚úÖ Repository: `https://github.com/thermofisher-labs/user-management-api`
- ‚úÖ All FastAPI code pushed
- ‚úÖ Ready for deployment

### Example 2: Add Auth to Existing FastAPI Project

```yaml
# Issue: Modify Existing Project
Target Repository: yashwanth-tfs/production-api
Project Type: Python (FastAPI)
Modification Type: feature
Description: Add JWT authentication with refresh tokens
Dependencies:
  - PyJWT==2.8.0
  - python-jose[cryptography]==3.3.0
```

**Result:**
- ‚úÖ PR created in `yashwanth-tfs/production-api`
- ‚úÖ Branch: `codegen/modify-45`
- ‚úÖ Files: auth routes, service, repository, tests
- ‚úÖ Updated: main.py, requirements.txt

### Example 3: Add Dashboard to Existing Angular App

```yaml
# Issue: Modify Existing Project
Target Repository: company/angular-crm
Project Type: Angular
Modification Type: feature
Description: Add analytics dashboard with charts
Dependencies:
  - @angular/material
  - chart.js
  - ng2-charts
```

**Result:**
- ‚úÖ PR created in `company/angular-crm`
- ‚úÖ Feature module: `app/features/dashboard/`
- ‚úÖ Components: dashboard, charts
- ‚úÖ Service: dashboard.service.ts
- ‚úÖ Routing updated

---

## Best Practices

### When Creating Separate Repositories

1. ‚úÖ **Review Generated Code** before creating repository
2. ‚úÖ **Configure Branch Protection** after creation
3. ‚úÖ **Add Collaborators** through repository settings
4. ‚úÖ **Set Up CI/CD** in the new repository
5. ‚úÖ **Update README** with project-specific details

### When Modifying Existing Projects

1. ‚úÖ **Always Review PRs** before merging
2. ‚úÖ **Test Modifications** locally first
3. ‚úÖ **Use Feature Branches** for experimentation
4. ‚úÖ **Document Changes** in commit messages
5. ‚úÖ **Run Tests** after applying modifications

### Security Considerations

1. üîí **Use PAT Securely** - Store in repository secrets only
2. üîí **Limit PAT Scope** - Only grant necessary permissions
3. üîí **Rotate PATs Regularly** - Update every 90 days
4. üîí **Review Modifications** - Never auto-merge generated code
5. üîí **Private by Default** - Use private repos for sensitive projects

---

## Troubleshooting

### "Project not found in generated-projects/"

**Solution:** Ensure the project was successfully generated first. Check `generated-projects/` folder.

### "Failed to create repository: already exists"

**Solution:** Repository name already taken. Use a different name or delete existing repository.

### "Failed to access target repository"

**Solutions:**
1. Verify PAT has correct permissions (`repo` scope)
2. Check PAT is added to repository secrets as `PAT_TOKEN`
3. Ensure you have access to target repository
4. Verify repository name is correct (`owner/repo`)

### "Modifications failed to apply"

**Solutions:**
1. Check project type matches (FastAPI/Angular)
2. Verify project structure matches expected layout
3. Review error messages in workflow logs
4. Try manual modification as fallback

---

## Migration Guide

### Migrating from Manual Process

**Before:**
```bash
# Manual repo creation
cd generated-projects/my-project
git init
gh repo create my-project --public
git add .
git commit -m "Initial commit"
git push
```

**After:**
```yaml
# Create issue with "Create Separate Repository" template
Project Name: my-project
Repository Visibility: public
# Workflow handles everything automatically
```

### Migrating from Direct Commits

**Before:**
```bash
# Direct commits to existing repo
cd my-existing-project
# make changes
git commit -m "Add feature"
git push
```

**After:**
```yaml
# Create issue with "Modify Existing Project" template
Target Repository: username/my-existing-project
Modification Type: feature
Description: Add new feature
# Workflow creates PR for review
```

---

## Summary

| Task | Method | Output |
|------|--------|--------|
| Create new repo from generated project | "Create Separate Repository" issue | New standalone repository |
| Add feature to existing repo | "Modify Existing Project" issue | PR in existing repository |
| Manual git setup | Direct git commands | Full control, more work |
| Automated workflow | GitHub Actions | Consistent, repeatable |

**Choose:**
- **Create Separate Repository** ‚Üí Move generated projects to production
- **Modify Existing Project** ‚Üí Extend existing applications
- **Manual Process** ‚Üí Full control and customization
